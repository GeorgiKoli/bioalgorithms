package com.georgikolishovski;

import java.util.Arrays;
import java.util.Collections;

import com.georgikolishovski.io.InputReader;

public class DnaReplication {
	 lib = null;
	
	public DnaReplication(InputReader input) {
		lib = new BioinformaticsLib();
	}
	
	/**
	 * 
	 * @param text
	 * @param k
	 * @param d
	 * @return
	 */
	public String FrequentWordsWithMismatchesRC(String text, int k, int d) {
		StringBuilder freqPatterns = new StringBuilder();
		String strArr[] = lib.ComputingFrequencies(text, k).split(" ");
		Integer freqArr[] = new Integer[strArr.length];
		
		for(int i = 0; i < freqArr.length; i++) {
			freqArr[i] = 0;
		}
		
		for(int i = 0; i < freqArr.length; i++) {
			int nsum = 0;
			String pattern = lib.NumberToPattern(i, k);
			String neighbors[] = lib.Neighbors(pattern, d).split(" ");
			String neighborsRC[] = lib.Neighbors(lib.ReverseComplement(pattern), d).split(" ");
			
			for(int j = 0; j < neighbors.length; j++) {
				nsum = nsum + Integer.parseInt(strArr[(int) lib.PatternToNumber(neighbors[j])]);
				nsum = nsum + Integer.parseInt(strArr[(int) lib.PatternToNumber(neighborsRC[j])]);
			}
			freqArr[i] = nsum;
		}
		int maxCount = (int) Collections.max(Arrays.asList(freqArr));
		
		for(int i = 0; i < freqArr.length; i++) {
			if(freqArr[i] >= maxCount) {
				freqPatterns.append(lib.NumberToPattern(i, k) + " ");
			}
		}
		return freqPatterns.toString().trim();
	}
}